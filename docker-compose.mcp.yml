services:
  mcpgateway:
    image: ghcr.io/ibm/mcp-context-forge:0.6.0
    container_name: mcpgateway
    profiles: ["mcp"]
    ports:
      - "4444:4444"
    environment:
      MCPGATEWAY_UI_ENABLED: "true"
      MCPGATEWAY_ADMIN_API_ENABLED: "true"
      HOST: "0.0.0.0"
      PORT: "4444"
      BASIC_AUTH_USER: "${MCP_ADMIN_USER:-admin}"
      BASIC_AUTH_PASSWORD: "${MCP_ADMIN_PASSWORD:-pass}"
      JWT_SECRET_KEY: "${JWT_SECRET_KEY:-my-key}"
    extra_hosts:
      - "host.docker.internal:host-gateway"

  mcp-sample:
    build:
      context: ./services/mcp-sample
      dockerfile: Dockerfile
    container_name: mcp-sample
    profiles: ["mcp"]
    environment:
      PYTHONIOENCODING: "utf-8"
    ports:
      - "8081:8000"
    healthcheck:
      test: ["CMD", "python", "-c", "import urllib.request,sys; urllib.request.urlopen('http://localhost:8000/health'); sys.exit(0)"]
      interval: 10s
      timeout: 3s
      retries: 10
    extra_hosts:
      - "host.docker.internal:host-gateway"
